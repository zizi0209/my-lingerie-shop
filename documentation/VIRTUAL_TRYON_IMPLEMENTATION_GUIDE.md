# Virtual Try-On Feature - Implementation Guide

## Feature Overview

| Attribute | Value |
|-----------|-------|
| **TÃªn Feature** | PhÃ²ng thá»­ Ä‘á»“ áº£o (AI Virtual Try-On) |
| **Priority** | Medium (Nice-to-have, khÃ´ng block MVP) |
| **Complexity** | Medium |
| **Estimated Time** | 2-3 tuáº§n |
| **Dependencies** | Hugging Face Spaces (external), @gradio/client |
| **Cost** | $0 (hoÃ n toÃ n miá»…n phÃ­) |

---

## User Story

```
LÃ  má»™t khÃ¡ch hÃ ng mua Ä‘á»“ lÃ³t online,
TÃ´i muá»‘n xem trÆ°á»›c sáº£n pháº©m sáº½ trÃ´ng nhÆ° tháº¿ nÃ o trÃªn cÆ¡ thá»ƒ tÃ´i,
Äá»ƒ tÃ´i cÃ³ thá»ƒ quyáº¿t Ä‘á»‹nh mua hÃ ng tá»± tin hÆ¡n vÃ  giáº£m kháº£ nÄƒng pháº£i Ä‘á»•i tráº£.
```

---

## Acceptance Criteria

- [ ] User cÃ³ thá»ƒ má»Ÿ modal "Thá»­ Ä‘á»“ áº£o" tá»« trang chi tiáº¿t sáº£n pháº©m
- [ ] User cÃ³ thá»ƒ upload áº£nh toÃ n thÃ¢n hoáº·c chá»¥p tá»« camera
- [ ] User pháº£i Ä‘á»“ng Ã½ consent trÆ°á»›c khi xá»­ lÃ½ áº£nh
- [ ] Há»‡ thá»‘ng hiá»ƒn thá»‹ tráº¡ng thÃ¡i queue vÃ  thá»i gian chá» Æ°á»›c tÃ­nh
- [ ] User cÃ³ thá»ƒ Ä‘Ã³ng modal vÃ  tiáº¿p tá»¥c shopping trong khi chá»
- [ ] User nháº­n notification khi áº£nh try-on hoÃ n thÃ nh
- [ ] User cÃ³ thá»ƒ táº£i áº£nh káº¿t quáº£ vá» mÃ¡y
- [ ] User cÃ³ thá»ƒ thá»­ láº¡i vá»›i áº£nh khÃ¡c
- [ ] Há»‡ thá»‘ng cÃ³ fallback khi HF Space khÃ´ng available

---

## How It Works (Technical Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TECHNICAL ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   USER BROWSER  â”‚         â”‚         HUGGING FACE SPACES              â”‚  â”‚
â”‚  â”‚   (Frontend)    â”‚         â”‚         (Free GPU Inference)             â”‚  â”‚
â”‚  â”‚                 â”‚         â”‚                                          â”‚  â”‚
â”‚  â”‚  1. User upload â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚     áº£nh toÃ n    â”‚         â”‚  â”‚  IDM-VTON Space (yisol/IDM-VTON)   â”‚  â”‚  â”‚
â”‚  â”‚     thÃ¢n        â”‚         â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚        â”‚        â”‚         â”‚  â”‚  â€¢ GPU: NVIDIA A10G (24GB VRAM)    â”‚  â”‚  â”‚
â”‚  â”‚        â–¼        â”‚         â”‚  â”‚  â€¢ Model: Diffusion-based VTON     â”‚  â”‚  â”‚
â”‚  â”‚  2. @gradio/    â”‚ â”€â”€â”€â”€â”€â”€â–º â”‚  â”‚  â€¢ Input: Person img + Garment img â”‚  â”‚  â”‚
â”‚  â”‚     client gá»­i  â”‚  HTTP   â”‚  â”‚  â€¢ Output: AI-generated try-on     â”‚  â”‚  â”‚
â”‚  â”‚     request     â”‚         â”‚  â”‚  â€¢ Time: 30-60s per image          â”‚  â”‚  â”‚
â”‚  â”‚        â”‚        â”‚         â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚  â”‚        â”‚        â”‚ â—„â”€â”€â”€â”€â”€â”€ â”‚  â”‚  Queue System (ZeroGPU)            â”‚  â”‚  â”‚
â”‚  â”‚        â–¼        â”‚  Image  â”‚  â”‚  â€¢ Shared GPU across all users     â”‚  â”‚  â”‚
â”‚  â”‚  3. Hiá»ƒn thá»‹    â”‚   URL   â”‚  â”‚  â€¢ Wait time: 30s - 5min           â”‚  â”‚  â”‚
â”‚  â”‚     káº¿t quáº£     â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                 â”‚         â”‚                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  Fallback Spaces:                        â”‚  â”‚
â”‚                              â”‚  â€¢ zhengchong/CatVTON                    â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â€¢ texelmoda/vton-d                      â”‚  â”‚
â”‚  â”‚  VERCEL (Host)  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚  Next.js App    â”‚                                                       â”‚
â”‚  â”‚  â€¢ KhÃ´ng xá»­ lÃ½  â”‚                                                       â”‚
â”‚  â”‚    AI á»Ÿ Ä‘Ã¢y     â”‚                                                       â”‚
â”‚  â”‚  â€¢ Chá»‰ serve    â”‚                                                       â”‚
â”‚  â”‚    static files â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ RAILWAY (Backendâ”‚  â—„â”€â”€ Optional: Chá»‰ logging/analytics                 â”‚
â”‚  â”‚  â€¢ KhÃ´ng xá»­ lÃ½  â”‚      KhÃ´ng xá»­ lÃ½ AI                                   â”‚
â”‚  â”‚    AI á»Ÿ Ä‘Ã¢y     â”‚                                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## User Flow (Step by Step)

### Step 1: Trang chi tiáº¿t sáº£n pháº©m

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCT DETAIL PAGE                       â”‚
â”‚                    /san-pham/[slug]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [Gallery áº£nh]         Ão ngá»±c ren Victoria                 â”‚
â”‚                        GiÃ¡: 450.000Ä‘                         â”‚
â”‚                                                             â”‚
â”‚                        Size: [S] [M] [L]                     â”‚
â”‚                        MÃ u:  â— â— â—                           â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚          ðŸ›’ THÃŠM VÃ€O GIá»Ž HÃ€NG           â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚       âœ¨ THá»¬ Äá»’ áº¢O (AI) - MIá»„N PHÃ     â”‚ â—„â”€â”€ NEW       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 2: Modal Upload áº£nh

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âœ¨ PhÃ²ng thá»­ Ä‘á»“ áº£o - Ão ngá»±c ren Victoria                   [X] â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                   â•‘
â•‘   áº¢NH Cá»¦A Báº N                    Sáº¢N PHáº¨M                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚        â”‚   [áº¢nh sáº£n pháº©m]   â”‚         â•‘
â•‘   â”‚   â”‚  ðŸ“¤ Upload  â”‚   â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚   â”‚   áº£nh cá»§a   â”‚   â”‚        â”‚   Ão ngá»±c ren      â”‚         â•‘
â•‘   â”‚   â”‚    báº¡n      â”‚   â”‚        â”‚   Victoria          â”‚         â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚   hoáº·c [ðŸ“· Camera]  â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â•‘
â•‘                                                                   â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚ ðŸ“¸ HÆ¯á»šNG DáºªN CHá»¤P áº¢NH                                     â”‚  â•‘
â•‘   â”‚ â€¢ Äá»©ng tháº³ng, máº·t hÆ°á»›ng camera                            â”‚  â•‘
â•‘   â”‚ â€¢ Máº·c quáº§n Ã¡o bÃ³ sÃ¡t hoáº·c Ä‘á»“ lÃ³t                          â”‚  â•‘
â•‘   â”‚ â€¢ Ná»n Ä‘Æ¡n giáº£n, Ã¡nh sÃ¡ng tá»‘t                              â”‚  â•‘
â•‘   â”‚ â€¢ áº¢nh toÃ n thÃ¢n rÃµ nÃ©t                                    â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                   â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚ â±ï¸ LÆ¯U Ã Vá»€ THá»œI GIAN                                     â”‚  â•‘
â•‘   â”‚ TÃ­nh nÄƒng sá»­ dá»¥ng AI miá»…n phÃ­, thá»i gian xá»­ lÃ½            â”‚  â•‘
â•‘   â”‚ tá»« 1-5 phÃºt tÃ¹y lÆ°á»£ng ngÆ°á»i dÃ¹ng.                         â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                   â•‘
â•‘   â˜‘ TÃ´i Ä‘á»“ng Ã½ cho phÃ©p xá»­ lÃ½ áº£nh. áº¢nh sáº½ Ä‘Æ°á»£c gá»­i Ä‘áº¿n           â•‘
â•‘     Hugging Face Ä‘á»ƒ xá»­ lÃ½ vÃ  KHÃ”NG Ä‘Æ°á»£c lÆ°u trá»¯.                  â•‘
â•‘                                                                   â•‘
â•‘                               [ÄÃ³ng]  [âœ¨ Thá»­ Ä‘á»“ ngay]           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Step 3: Äang xá»­ lÃ½ (1-5 phÃºt)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âœ¨ Äang xá»­ lÃ½...                                            [X] â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                   â•‘
â•‘   áº¢NH ÄÃƒ UPLOAD                  ÄANG Xá»¬ LÃ                      â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚   [áº¢nh user Ä‘Ã£      â”‚        â”‚        ðŸ”„           â”‚         â•‘
â•‘   â”‚    upload]          â”‚        â”‚    Loading...       â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚   Vá»‹ trÃ­ hÃ ng Ä‘á»£i:  â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚   3 / 8             â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 75%   â”‚         â•‘
â•‘                                  â”‚                     â”‚         â•‘
â•‘                                  â”‚   ~2 phÃºt cÃ²n láº¡i   â”‚         â•‘
â•‘                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â•‘
â•‘                                                                   â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚ ðŸ’¡ Máº¸O: Báº¡n cÃ³ thá»ƒ Ä‘Ã³ng modal nÃ y vÃ  tiáº¿p tá»¥c xem         â”‚  â•‘
â•‘   â”‚ sáº£n pháº©m khÃ¡c. ChÃºng tÃ´i sáº½ thÃ´ng bÃ¡o khi hoÃ n táº¥t!       â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                   â•‘
â•‘                      [Tiáº¿p tá»¥c shopping]  [Há»§y xá»­ lÃ½]            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Step 4: Notification khi hoÃ n thÃ nh (náº¿u user Ä‘Ã³ng modal)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨ áº¢nh thá»­ Ä‘á»“ Ä‘Ã£ sáºµn sÃ ng!                               â”‚
â”‚  Ão ngá»±c ren Victoria                                     â”‚
â”‚                                      [Xem káº¿t quáº£]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–²
                    â”‚
            Toast notification
            xuáº¥t hiá»‡n á»Ÿ gÃ³c mÃ n hÃ¬nh
```

### Step 5: Hiá»ƒn thá»‹ káº¿t quáº£

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âœ¨ Káº¿t quáº£ thá»­ Ä‘á»“ áº£o                                        [X] â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                   â•‘
â•‘   áº¢NH Gá»C                        Káº¾T QUáº¢ AI                      â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚   [áº¢nh user Ä‘Ã£      â”‚   â†’    â”‚   [áº¢NH AI GENERATED]â”‚         â•‘
â•‘   â”‚    upload]          â”‚        â”‚                     â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚   User máº·c sáº£n pháº©m â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚   Ä‘Æ°á»£c chá»n         â”‚         â•‘
â•‘   â”‚                     â”‚        â”‚                     â”‚         â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â•‘
â•‘                                                                   â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚ Ão ngá»±c ren Victoria - Size M - MÃ u Äen                   â”‚  â•‘
â•‘   â”‚ GiÃ¡: 450.000Ä‘                                             â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                   â•‘
â•‘   [ðŸ“¥ Táº£i áº£nh vá»]  [ðŸ”„ Thá»­ áº£nh khÃ¡c]  [ðŸ›’ ThÃªm vÃ o giá» hÃ ng]    â•‘
â•‘                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Timeline: Thá»i gian user pháº£i chá»

| TrÆ°á»ng há»£p | Cold Start | Queue | AI Processing | **Tá»”NG** |
|------------|------------|-------|---------------|----------|
| **Best case** (Space active, Ã­t ngÆ°á»i) | 0s | 0s | 30s | **~30 giÃ¢y** |
| **Average** (Space active, vá»«a ngÆ°á»i) | 0s | 60s | 45s | **~2 phÃºt** |
| **Worst case** (Space sleeping, Ä‘Ã´ng) | 30s | 300s | 60s | **~6-7 phÃºt** |

### Giáº£i thÃ­ch

- **Cold Start**: Khi HF Space khÃ´ng ai dÃ¹ng trong 15-30 phÃºt, nÃ³ sáº½ "sleep" Ä‘á»ƒ tiáº¿t kiá»‡m tÃ i nguyÃªn. User Ä‘áº§u tiÃªn pháº£i chá» 10-30s Ä‘á»ƒ "Ä‘Ã¡nh thá»©c".
- **Queue**: GPU Ä‘Æ°á»£c chia sáº» giá»¯a táº¥t cáº£ users trÃªn tháº¿ giá»›i. Khi Ä‘Ã´ng, pháº£i xáº¿p hÃ ng chá».
- **AI Processing**: Thá»i gian thá»±c táº¿ AI xá»­ lÃ½ 1 áº£nh (30-60s).

---

## Component Architecture

```
frontend/src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ virtual-tryon/
â”‚       â”œâ”€â”€ VirtualTryOnButton.tsx       # Button trÃªn product page
â”‚       â”œâ”€â”€ VirtualTryOnModal.tsx        # Modal container chÃ­nh
â”‚       â”œâ”€â”€ PhotoUploader.tsx            # Upload hoáº·c camera
â”‚       â”œâ”€â”€ ConsentCheckbox.tsx          # Privacy consent
â”‚       â”œâ”€â”€ ProcessingView.tsx           # Loading state
â”‚       â”œâ”€â”€ ResultView.tsx               # Káº¿t quáº£
â”‚       â”œâ”€â”€ TryOnNotification.tsx        # Toast notification
â”‚       â””â”€â”€ index.ts                     # Barrel export
â”‚
â”œâ”€â”€ services/
â”‚   â””â”€â”€ virtual-tryon/
â”‚       â””â”€â”€ huggingface-client.ts        # Gradio client
â”‚
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useVirtualTryOn.ts               # Main hook
â”‚
â”œâ”€â”€ context/
â”‚   â””â”€â”€ VirtualTryOnContext.tsx          # Background processing state
â”‚
â””â”€â”€ types/
    â””â”€â”€ virtual-tryon.ts                 # TypeScript interfaces
```

---

## Implementation Tasks

### Phase 1: Core Infrastructure (Tuáº§n 1)

| # | Task | Priority | Estimate |
|---|------|----------|----------|
| 1 | Install @gradio/client | High | 30m |
| 2 | Create TypeScript interfaces | High | 1h |
| 3 | Create huggingface-client.ts | High | 4h |
| 4 | Create useVirtualTryOn hook | High | 3h |
| 5 | Create VirtualTryOnContext | Medium | 2h |

### Phase 2: UI Components (Tuáº§n 1-2)

| # | Task | Priority | Estimate |
|---|------|----------|----------|
| 6 | VirtualTryOnButton | High | 1h |
| 7 | VirtualTryOnModal (shell) | High | 2h |
| 8 | PhotoUploader (file) | High | 3h |
| 9 | PhotoUploader (camera) | Medium | 3h |
| 10 | ConsentCheckbox | High | 1h |
| 11 | ProcessingView | High | 2h |
| 12 | ResultView | High | 2h |
| 13 | TryOnNotification | Medium | 1h |

### Phase 3: Integration (Tuáº§n 2)

| # | Task | Priority | Estimate |
|---|------|----------|----------|
| 14 | Integrate vÃ o Product Detail | High | 2h |
| 15 | Background processing | Medium | 3h |
| 16 | Error handling & fallbacks | High | 2h |
| 17 | Loading states & animations | Medium | 2h |

### Phase 4: Polish (Tuáº§n 2-3)

| # | Task | Priority | Estimate |
|---|------|----------|----------|
| 18 | Mobile responsive | High | 3h |
| 19 | Accessibility | Medium | 2h |
| 20 | Unit tests | Medium | 4h |
| 21 | E2E tests | Low | 3h |

---

## Dependencies to Install

```bash
cd frontend
npm install @gradio/client react-webcam
```

---

## Files to Create

```
frontend/src/
â”œâ”€â”€ components/virtual-tryon/
â”‚   â”œâ”€â”€ VirtualTryOnButton.tsx
â”‚   â”œâ”€â”€ VirtualTryOnModal.tsx
â”‚   â”œâ”€â”€ PhotoUploader.tsx
â”‚   â”œâ”€â”€ ConsentCheckbox.tsx
â”‚   â”œâ”€â”€ ProcessingView.tsx
â”‚   â”œâ”€â”€ ResultView.tsx
â”‚   â”œâ”€â”€ TryOnNotification.tsx
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ services/virtual-tryon/
â”‚   â””â”€â”€ huggingface-client.ts
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useVirtualTryOn.ts
â”œâ”€â”€ context/
â”‚   â””â”€â”€ VirtualTryOnContext.tsx
â””â”€â”€ types/
    â””â”€â”€ virtual-tryon.ts
```

---

## Files to Modify

```
frontend/src/app/san-pham/[slug]/page.tsx
  â””â”€â”€ ThÃªm VirtualTryOnButton vÃ o product detail

frontend/src/components/layout/Providers.tsx
  â””â”€â”€ Wrap vá»›i VirtualTryOnProvider (cho background processing)
```

---

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| HF Space down | High | Multiple fallback spaces |
| Long queue frustrates users | Medium | Clear UX communication |
| Poor AI result | Medium | Disclaimer, allow retry |
| Privacy concerns | High | Clear consent, explain data flow |
| CORS issues | Medium | Test early |

---

## Privacy Considerations (Quan trá»ng cho Lingerie!)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA FLOW                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. User uploads photo â”€â”€â–º Vercel (temporary, in memory)   â”‚
â”‚                                â”‚                            â”‚
â”‚  2. Photo sent via HTTPS â”€â”€â”€â”€â”€â–º Hugging Face Space         â”‚
â”‚                                â”‚                            â”‚
â”‚  3. HF processes on GPU â”€â”€â”€â”€â”€â”€â–º Generated image returned   â”‚
â”‚                                â”‚                            â”‚
â”‚  4. Original photo â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º NOT STORED by HF           â”‚
â”‚                                                             â”‚
â”‚  âš ï¸  áº¢nh Ä‘i qua internet Ä‘áº¿n HF servers (US/EU)            â”‚
â”‚  âš ï¸  HF cÃ³ thá»ƒ log metadata (IP, timestamp)                â”‚
â”‚  âœ“  áº¢nh khÃ´ng lÆ°u lÃ¢u dÃ i                                  â”‚
â”‚  âœ“  KhÃ´ng lÆ°u trÃªn Railway/Vercel                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Required in UI:**
1. Consent checkbox (báº¯t buá»™c trÆ°á»›c khi upload)
2. Giáº£i thÃ­ch rÃµ áº£nh Ä‘Æ°á»£c gá»­i Ä‘áº¿n Ä‘Ã¢u
3. Khuyáº¿n cÃ¡o khÃ´ng upload áº£nh quÃ¡ nháº¡y cáº£m
4. (Optional) Option Ä‘á»ƒ blur máº·t

---

## Success Metrics

| Metric | Target | How to Measure |
|--------|--------|----------------|
| Completion rate | > 60% | Started vs Completed |
| Conversion lift | > 15% | A/B test |
| User satisfaction | > 4/5 | Survey |
| Error rate | < 5% | Logs |

---

## Pre-Implementation Checklist

- [x] Feature specification complete
- [x] User flow documented
- [x] Component architecture defined
- [x] Implementation tasks listed
- [x] Risks identified
- [ ] Test HF Space manually: https://huggingface.co/spaces/yisol/IDM-VTON
- [ ] Identify product detail page location
- [ ] Install dependencies

---

## Quick Links

- **IDM-VTON Demo**: https://huggingface.co/spaces/yisol/IDM-VTON
- **Gradio Client Docs**: https://www.gradio.app/guides/getting-started-with-the-js-client
- **Best Practices Doc**: ./VIRTUAL_TRYON_BEST_PRACTICES.md

---

## Next Step

```bash
# 1. Install dependencies
cd frontend
npm install @gradio/client react-webcam

# 2. Test HF Space manually first
# Go to: https://huggingface.co/spaces/yisol/IDM-VTON
# Try uploading a test image to understand the flow

# 3. Start implementing Phase 1
```
*** End Patch
